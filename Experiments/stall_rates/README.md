# Stall Rate Experiments

This experiment set includes the queue size experiments in the Banked Sketching Section and the merging experiments from the Evaluation. The experiments are rather time consuming an the simulator is sequential. Thus, we decided to use the make build system as a scheduler for parallel execution. The makefile is generated by a Python script. Conveniently, it also downloads datasets and compiles the simulator and hasher.

```
parallelism=256                                   # Number of threads on your system
variant="cross"                                   # Cross products of all parameters. Takes very long.
variant="queue_size"                              # Queue size experiments, no mergers, just queue size
variant="merging"                                 # Default queue sizes with various degrees of merging
python generate_make_file.py $variant > Makefile
make all -j $parallelism
```

Besides make, this only needs g++ and python with the dependencies listed on the main README page.

After the program is executed, you'll find one CSV file for every run in the folder. Not very convient, better create one CSV File per dataset.
```
cat uniform_*.csv > uniform.csv
cat zipf_1.05_*.csv > zipf_1.05.csv
cat zipf_1.1_*.csv > zipf_1.1.csv
cat zipf_1.5_*.csv > zipf_1.5.csv
cat wc98_*.csv > wc98.csv
cat caida_*.csv > caida.csv
cat nyt_*.csv > nyt.csv
```

The format of the csv file is
```
"rows", "columns", "inputs",  "banks", "queue_size", "horizontal_look_ahead", "unused_parameter", "has_vertical_merging", "cycles", "stalls", "stall_rate"
```                                           
